<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Predictor</title>


    <!-- Custom CSS -->
    <link rel="stylesheet" href="../static/styles.css" />
  </head>
  <body>

    <nav>
      <img
      class="nav-logo"
      src="../static/logo.png"
      alt="Logo"
    />

    <div class="nav-spacer"></div>

    <div class="nav-links">
      <div class="nav-items">
        <a href="#">Help</a>
        <a href="../../dashboard.html" id="open-login">Dashboard</a>
        <a href="signup.html" class="signup-btn">Profile</a>
      </div>
    </div>
    </nav>


    <!-- Floating Chatbot Button -->
    <button class="chatbot-button" onclick="toggleChatbot()">ðŸ¤–</button>

    <!-- Chatbot Container -->
    <div class="chatbot-container" id="chatbotContainer">
      <iframe
        class="chatbot-iframe"
        src="https://bijayrauniyar-hello-doc.vercel.app/"
      ></iframe>
    </div>

   

        

    <div class="container-wrapper">
      <div class="content">
        <img
          src="../static/left-main.png"
          class="leftmain"
        />
        <div class="form-container">
          <form action="/predict" method="post">
            <div class="form-group">
              <label for="symptoms">Select Symptoms</label>
              <div class="tags-container" id="tagsContainer">
                <input
                  type="text"
                  id="symptomsInput"
                  class="tag-input"
                  placeholder="Type symptoms..."
                  list="symptomsList"
                />
              </div>
              <input type="hidden" id="symptoms" name="symptoms" />
              <datalist id="symptomsList"></datalist>
              <!-- Make sure this exists in HTML -->
            </div>

            <div class="form-group">
              <label for="symptom_duration">Time Since Symptoms</label>
              <select
                class="form-control"
                id="symptom_duration"
                name="symptom_duration"
              >
                <option value="1">1 Day</option>
                <option value="2">2 Days</option>
                <option value="3">3 Days</option>
                <option value="4">4 Days</option>
                <option value="5+">5+ Days</option>
              </select>
            </div>

            <div class="form-group">
              <label for="notes">Notes</label>
              <textarea
                class="form-control"
                id="notes"
                name="notes"
                rows="4"
                placeholder="Describe your symptoms in detail..."
              ></textarea>
            </div>

            <button type="submit" class="btn btn-danger btn-lg submit-btn">
              Predict
            </button>
          </form>
        </div>
      </div>
    </div>

    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>

    <!-- JavaScript for Tag-based Symptoms Selection -->
    <script>
      // This is the code for the chatbot button and container
      // Function to toggle the visibility of the chatbot container
      // This function is called when the chatbot button is clicked
      function toggleChatbot() {
        const chatbot = document.getElementById("chatbotContainer");
        chatbot.style.display =
          chatbot.style.display === "block" ? "none" : "block";
      }
      // The above code is for the chatbot button and container

      document.addEventListener("DOMContentLoaded", function () {
        const symptomsList = [
          "itching",
          "skin_rash",
          "nodal_skin_eruptions",
          "continuous_sneezing",
          "shivering",
          "chills",
          "joint_pain",
          "stomach_pain",
          "acidity",
          "ulcers_on_tongue",
          "muscle_wasting",
          "vomiting",
          "burning_micturition",
          "spotting_urination",
          "fatigue",
          "weight_gain",
          "anxiety",
          "cold_hands_and_feets",
          "mood_swings",
          "weight_loss",
          "restlessness",
          "lethargy",
          "patches_in_throat",
          "irregular_sugar_level",
          "cough",
          "fever",
          "sunken_eyes",
          "breathlessness",
          "sweating",
          "dehydration",
          "indigestion",
          "headache",
          "yellowish_skin",
          "dark_urine",
          "nausea",
          "loss_of_appetite",
          "pain_behind_the_eyes",
          "back_pain",
          "constipation",
          "abdominal_pain",
          "diarrhoea",
          "mild_fever",
          "yellow_urine",
          "yellowing_of_eyes",
          "acute_liver_failure",
          "fluid_overload",
          "swelling_of_stomach",
          "swelled_lymph_nodes",
          "malaise",
          "blurred_and_distorted_vision",
          "phlegm",
          "throat_irritation",
          "redness_of_eyes",
          "sinus_pressure",
          "runny_nose",
          "congestion",
          "chest_pain",
          "weakness_in_limbs",
          "fast_heart_rate",
          "pain_during_bowel_movements",
          "pain_in_anal_region",
          "bloody_stool",
          "irritation_in_anus",
          "neck_pain",
          "dizziness",
          "cramps",
          "bruising",
          "obesity",
          "swollen_legs",
          "swollen_blood_vessels",
          "puffy_face_and_eyes",
          "enlarged_thyroid",
          "brittle_nails",
          "swollen_extremeties",
          "excessive_hunger",
          "extra_marital_contacts",
          "drying_and_tingling_lips",
          "slurred_speech",
          "knee_pain",
          "hip_joint_pain",
          "weakness",
          "stiff_neck",
          "swelling_joints",
          "movement_stiffness",
          "spinning_movements",
          "malnutrition",
          "unsteadiness",
          "weakness_of_one_body_side",
          "loss_of_smell",
          "bladder_discomfort",
          "foul_smell_of_urine",
          "continuous_feel_of_urine",
          "passage_of_gases",
          "internal_itching",
          "toxic_look_(typhos)",
          "depression",
          "irritability",
          "muscle_pain",
          "altered_sensorium",
          "red_spots_over_body",
          "belly_pain",
          "abnormal_menstruation",
          "dischromic_patches",
          "watering_from_eyes",
          "increased_appetite",
          "polyuria",
          "family_history",
          "mucoid_sputum",
          "rusty_sputum",
          "lack_of_concentration",
          "visual_disturbances",
          "receiving_blood_transfusion",
          "receiving_unsterile_injections",
          "sleep",
          "stomach_bleeding",
          "distention_of_abdomen",
          "history_of_alcohol_consumption",
          "fluid_overload.1",
          "blood_in_sputum",
          "prominent_veins_on_calf",
          "palpitations",
          "painful_walking",
          "pus_filled_pimples",
          "blackheads",
          "scurring",
          "skin_peeling",
          "silver_like_dusting",
          "small_dents_in_nails",
          "inflammatory_nails",
          "blister",
          "red_sore_around_nose",
          "yellow_crust_ooze",
        ];

        const inputField = document.getElementById("symptomsInput");
        const datalist = document.getElementById("symptomsList");
        const tagsContainer = document.getElementById("tagsContainer");
        const hiddenInput = document.getElementById("symptoms");
        const form = document.querySelector("form");

        let selectedSymptoms = [];

        // Populate the datalist
        symptomsList.forEach((symptom) => {
          let option = document.createElement("option");
          option.value = symptom;
          datalist.appendChild(option);
        });

        inputField.addEventListener("input", function () {
          let enteredValue = inputField.value.trim();
          if (
            enteredValue &&
            symptomsList.includes(enteredValue) &&
            !selectedSymptoms.includes(enteredValue)
          ) {
            addSymptom(enteredValue);
            inputField.value = ""; // Clear input
            setTimeout(() => inputField.focus(), 10); // Keep focus on input field
          }
        });

        function addSymptom(symptom) {
          if (selectedSymptoms.length >= 4) {
            inputField.disabled = true; // Disable input after 4 symptoms
            return;
          }

          selectedSymptoms.push(symptom);
          updateTags();
        }

        function updateTags() {
          tagsContainer.innerHTML = ""; // Clear existing tags

          selectedSymptoms.forEach((symptom) => {
            let tag = document.createElement("div");
            tag.className = "tag";
            tag.innerHTML = `${symptom} <span class="remove-tag">&times;</span>`;
            tag
              .querySelector(".remove-tag")
              .addEventListener("click", () => removeSymptom(symptom));
            tagsContainer.appendChild(tag);
          });

          // Add input field back if less than 4 symptoms
          if (selectedSymptoms.length < 4) {
            inputField.disabled = false;
            tagsContainer.appendChild(inputField);
          }

          // Store selected symptoms in hidden input
          hiddenInput.value = selectedSymptoms.join(",");
        }

        function removeSymptom(symptom) {
          selectedSymptoms = selectedSymptoms.filter((s) => s !== symptom);
          inputField.disabled = false; // Enable input if symptoms are removed
          updateTags();
        }

        // Ensure form submits only if symptoms are selected
        form.addEventListener("submit", function (event) {
          if (selectedSymptoms.length === 0) {
            alert("Please select at least one symptom before submitting.");
            event.preventDefault(); // Prevent form submission if empty
          }
        });
      });
    </script>
  </body>
</html>
